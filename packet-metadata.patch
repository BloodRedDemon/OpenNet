--- original/src/network/model/packet-metadata.cc	2013-10-16 14:33:48.000000000 +0800
+++ src/network/model/packet-metadata.cc	2013-10-16 14:34:33.000000000 +0800
@@ -1141,7 +1141,7 @@
     {
       NS_ASSERT (false);
     }
-  m_offset += extraItem.fragmentEnd - extraItem.fragmentStart;
+  m_offset += extraItem.fragmentEnd - extraItem.fragmentStart - m_offset;
   return item;
 }
 
